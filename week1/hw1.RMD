---
title: "HW1 and R basic"
author: "廖昱嘉"
date: "2018/7/8"
output: html_document
---
<h2 id = '0'></h2>    
* [Introduction to R](#1)   
    + [四則運算](#1.1)   
    + [變數](#1.2)   
    + [向量](#1.3)   
    + [矩陣](#1.4)   
    + [因素向量](#1.5)   
    + [資料框dataframe](#1.6)    
    + [清單list](#1.7)   
* [Intermediate R](#2)   
    + [Conditionals and Control Flow](#2.1)   
    + [Loops](#2.2)   
    + [Functions](#2.3)   
    + [The apply family](#2.4)    
    + [Utilities](#2.5)   
* [Introduction to the tidyverse](#3)    

<h2 id = '1'></h2>
# Introduction to R   

<h3 id = '1.1'></h3>
## 四則運算   

```{r}
66+666
```
```{r}
666-66
```
```{r}
4*3
```
```{r}
9/3
```
```{r}
9%%5
```

<h3 id = '1.2></h3>
## 變數
變數有四種:數值，整數，邏輯值，文字 可以用函數class()來檢查此變數的種類
```{r}
apple<-5
```
```{r}
class(apple)
```
請注意，不同種類的變數不能相加    
```{r}
banana<-"好吃"
```
banana不能+apple，因為一個是字串一個是數值    
<h3 id = '1.3'></h3>
## 向量
使用c()來創造向量，並使用逗號分隔向量中的元素，比如:    
```{r}
sisters<-c(6,8,10)
```
```{r}
fruit<-c("watermelon","pineapple","orange")
```
用names()來為向量命名，使資料更加一目瞭然   
```{r}
names(sisters)<-c("小花","小美","小芒果")
```
```{r}
sisters
```
向量裡的種類如果相同，也是可以相加的唷!   
假設小胖(pon)有的美金、台幣、黃金總共(6,6,6)    
```{r}
pon<-c(6,6,6)
```
小美(mei)是(8,8,12)
```{r}
mei<-c(8,8,12)
```
```{r}
total<-pon+mei
```
```{r}
total
```
我們可以用sum()這函數來相加向量內所有東西   
```{r}
sum(mei)
```
假設兩向量所有的元素一樣，種類又一樣，就可以比較!   
```{r}
mei>pon
```
用向量[數字]可以查詢，比如我想查詢小美有多少黃金    
```{r}
mei[3]
```
!!!R語言第一個元素是1，不是0唷    
向量[C(數字,數字)]可以查詢該向量的多個數值    
比如說我想查詢小美的美金和台幣還有黃金，他的向量編號是1和2和3，    
那就是c(1,2,3)    
```{r}
mei[c(1,2,3)]
```
上述這個方法要打三個數字，如果他是連續    
其實可以打(1:3)   
```{r}
mei[c(1:3)]
```
那如果不知道他的順序怎辦?   
其實可以從他的命名查詢    
```{r}
names(mei)<-c("us","tw","gold")
```
接下來我想查詢小美的美金和黃金    
```{r}
mei[c("us","gold")]
```
函數mean()可以計算該選向量或選取的向量的平均值    
```{r}
mean(mei)
```
以下是R的比較運算子，就如上述比較小胖小美的美金、台幣和黃金，比較結果正確會回傳TRUE，錯了會回傳FALSE   
大於>   
小於<   
不大於<=    
不小於>=    
等於==    
不等於!=    
向量[比較後的向量]這樣的寫法可以挑出已經比好過後的值    
假設我想找小美大於10的財物    
那我可以先進行比較    
```{r}
bigthan10<-mei>10
```
然後再以此比較出的TRUE,FALSE挑選出我要的東西    
```{r}
mei[bigthan10]
``` 
這樣的好處，在於可以在我不確定該向量所有資訊時    
能快速挑選出我要的東西    
<h3 id = '1.4'></h3>
## 矩陣
甚麼是矩陣阿?   
就是有列與欄的資料型態    
用matrix()創造矩陣    
以下三點(matrix的三個參數)是matrix函數的重點    
1. 第一個參數是要放進矩陣的元素1:9是(1,2,3,4,5,6,7,8,9)的簡單寫法    
2. 第二個參數byrow如果=TRUE就是填滿矩陣時已列的方向放入元素，FALSE則為以欄的方向填滿   
3. 第三個函數nrow表示矩陣有3列    
以下先用向量創造元素，在排列出一個矩陣    
分別是小已(yee)、小龍(lon)、小芳(fon)所持有的黃金和鑽石   
```{r}
yee<-c(80,100)
```
```{r}
lon<-c(90,90)
```
```{r}
fon<-c(60,120)
```
再來組裝成矩陣    
```{r}
property<-matrix(c(yee,lon,fon),byrow=TRUE,nrow=3)
```
```{r}
property
```
用rownames()和colnames()可以為矩陣的列與欄命名    
```{r}
keeper<-c("yee","lon","fon")
```
```{r}
mineral<-c("gold","diamond")
```
```{r}
rownames(property)<-keeper
colnames(property)<-mineral
property
```
rowSums()函數可以相加矩陣中每個列的總和，產生新的向量   
```{r}
eachoneproperty<-rowSums(property)
eachoneproperty
```
cbind()函數可以增加矩陣的欄(前提是該向量所相加矩陣同樣數量的列)   
```{r}
big_property<-cbind(property,eachoneproperty)
big_property
```
rbind()函數可以增加矩陣的列   
```{r}
tsai<-c(20,160)
fourkeeper<-rbind(property,tsai)
fourkeeper
```
用ls()函數可以檢視工作區的內容(所有指令出的向量、矩陣...所有東西)   
```{r}
ls()
```
colSums()相對於rowSums()，是用來相加欄的!   
```{r}
minetotal<-colSums(property)
minetotal
```
矩陣的查詢    
矩陣[1,2]可以選出該矩陣第一列第二欄的元素   
矩陣[1:3,2:4]可以選出該矩陣第一列至第三列與第二欄至第四欄的元素    
矩陣[,1]會列出第一欄的所有元素    
矩陣[1,]則會列出第一列的所有元素    
矩陣的計算    
矩陣是可以計算的!!!比如黃金和鑽石每公斤都是10000元    
```{r}
money<-property*10000
money
```
但如果黃金和鑽石每公斤價格不一樣呢??    
還是可以計算的    
```{r}
price<-c(20,600)
true_money<-property*price
true_money
```
請注意，上述矩陣運算不是標準的，標準矩陣運算子要使用%*%喔    
<h3 id = '1.5'></h3>
## 因素向量
因素向量是用來儲存類別型變數的統計資料，類別型變數與連續型變數最主要的差異在於    
類別型變數有類別個數的上限!!!而連續型變數則會有無窮多的個數    
一個好的因素向量範例是生理性別，每一個觀測值都可以被分類成生理男性或生理女性    
factor()函數來宣告因素向量，以下以生理性別作範例    
```{r}
gender_vector<-c("Male","Female","Female","Male","Male")
factor_gender_vector<-factor(gender_vector)
factor_gender_vector
```
因素向量的類別型變數又可分為名目類別型變數和順序類別型變數，比如有個因素向量有五種動物，你無法比較各種動物間的好壞，他就為名目類別型變數，反之，順序類別型變數有天生的比較特性，比如溫度分低中高，中就比低大，高就比中大。    
用levels()這個函數來改變因素向量級別的名稱，以下以生理性別作範例，請注意改變名稱時輸入順序非常重要，R預設是以字母順序排列，所以要把male>M，femal>F，順序要是先f在m，千萬別反了，不然資料就跟著反了。    
```{r}
levels(factor_gender_vector)<-c("F","M")
factor_gender_vector
```
summary()函數可以使我們快速得到一組資料的摘要，以下仍然以生理性別為範例，用summary可以讓我們快速知道有多少生理男性和生理女性。    
```{r}
summary(gender_vector)
summary(factor_gender_vector)
```
從上面結果可以知道，如果summary因素向量，他會不同於一般向量，把每個類別的個數顯示出來    
順序型因素向量比較  
以下用速度作為介紹

```{r}
speed<-c("fast","slow","slow","fast","insane")
```
在factor()在加入ordered和levels才能使因素向量指定為順序型因素向量
```{r}
factor_speed<-factor(speed,ordered = TRUE, levels=c("slow","fast","insane"))
factor_speed
summary(speed)
summary(factor_speed)
```
順序型因素向量才能比較，名目型因素向量步行比較
```{r}
da2<-factor_speed[2]
da5<-factor_speed[5]
da2 > da5
```
<h3 id = '1.6'></h3>
## 資料框(dataframe)    
矩陣中的元素是相同的，資料框可以是不同的!!!   
因為他的觀測值儲存為列，變數儲存為欄!!!   
head()函數可以使你先觀察前六個資料    
str()函數可以告訴我們資料框的訊息   
包括觀測值的總數、變數的總數、變數名稱清單、變數的資料類型和前幾個觀測值，建議拿到一筆資料時都限用此函數來瞭幾這筆資料的樣態    
data.frame()函數就是來建立資料框的!以下以太陽系八大行星為範例    
```{r}
name<-c("Mercury","Venus","Earth","Mars","Jupiter","Saturn","Uranus","Neptune")
type<-c("Terrestrial planet", "Terrestrial planet", "Terrestrial planet", "Terrestrial planet", "Gas giant", "Gas giant", "Gas giant", "Gas giant")
diameter <- c(0.382, 0.949, 1, 0.532, 11.209, 9.449, 4.007, 3.883)
rotation <- c(58.64, -243.02, 1, 1.03, 0.41, 0.43, -0.72, 0.67)
rings <- c(FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, TRUE, TRUE)
planet_df<-data.frame(name,type,diameter,rotation,rings)
planet_df
```
dataframe的查詢   
資料框[1,2]將此dataframe第一列第二欄的元素選出    
資料框[1:3,2:4]將dataframe第一到第三列嶼第二至第四欄的元素選出    
資料框[1,]會把第一列所有元素選出    
```{r}
planet_df[1,3]
```
這是水星的直徑    
```{r}
planet_df[4,]
```
這是火星所有的資訊    
我們也可以用dataframe的名稱來進行查詢，在我們不知道他的欄位的時候    
```{r}
planet_df[1:5,"diameter"]
```
$符號的運用   
如果要選出diameter變數的所有值可以這樣子    
```{r}
planet_df[,3]
planet_df[,"diameter"]
planet_df$diameter
```
邏輯值(TRUE,FALSE)的向量在dataframe的查詢是可以快速使用的，假設我們要找有環的星球，可以這樣做    
```{r}
planet_df[rings,]
```
subset()函數可以更快速做到上述的答案    
subset(所選dataframe,所搜尋情況)    
比如    
```{r}
subset(planet_df,subset = rings)
```
請注意subset所蒐尋的情況不只搜尋欄位名稱，還可以進行比較   
```{r}
subset(planet_df,diameter<1)
```
這樣可以選出直徑<1的星球    
排序    
用order()函數可以讓某個欄位排序資料框的觀測值
```{r}
a<-c(6,10,8)
order(a)
a[order(a)]
```
這當然也能用在資料框(dataframe)
```{r}
positions<-order(planet_df$diameter)
planet_df[positions,]
```
這樣資料框就已直徑小到大做排序囉

<h3 id = '1.7'></h3>
## 清單list  

清單可以蒐集多樣性的物件，包含矩陣、向量、資料框甚至清單!!!這些物件不需要彼此相關，清單可謂超級資料類型阿，任何資訊都可以儲存在清單中!   
假設我把前面所學的向量(妹妹們)、矩陣(黃金與鑽石)、資料框(八大行星)和在一個清單上    
我必須要用list()函數
```{r}
my_list<-list(sisters,property,planet_df)
my_list
```
一樣，用names()函數來為list命名
```{r}
names(my_list)<-c("sis","good","planet")
my_list
```
其實阿，當初在列清單，使用lsit()函數時，就可以在list(名字1=所加入項目1,名字2=所加入項目2....)來進行命名了
清單的選取非常不值觀    
假設我想選取我三位妹妹其中一位小芒果(他在第一個清單，他是向量裡的第三位)   
```{r}
my_list[[1]][3]
```
如何在清單補充遺漏資訊呢?   
一樣用c()函數為清單增加資訊   
假設這清單建立於2018/7/8    
```{r}
real_list<-c(my_list,date="2017年7月8日")
real_list
```
* [回目錄](#0)

<h2 id = '2'></h2>
# Intermediate R

<h3 id ='2.1'></h3>
## Conditionals and Control Flow
Equality
```{r}
TRUE == FALSE # 比較邏輯值
-6*14 != 17-101 # 比較數值
"useR" == "uset" # 比較文字
TRUE == 1 #比較邏輯值和數字
```
watch out!Since TRUE coerces to1= 1 under the hood,   
TRUE == 1 evaluates to TRUE.Make sure not to mix up ==(comparison) amd =(assignment).== is what need to check the equality of R objects.
比大小    
```{r}
-6*5+2 >=-10+1
"raining" <= "raining dogs"#先比較開頭字母，在比較字串長度
TRUE > FALSE # TRUE是1 FALSE是0，1當然大於0
```
若兩向量(vector)相同數量也相同種類，那就可以比較    
其實不只向量啦，矩陣值裡面都一樣也可以比較    
Logical operators
&就是and要所有都TRUE才會顯示TRUE    
|就是or其中一個是TRUE就會顯示TRUE
!叫做邏輯非運算符會把得出的答案顛倒   
&&只比較向量中第一個值唷    
||也一樣只比較向量中第一個值    
所以&&和||在向量比較後都只會傳回一個值唷
```{r}
c(TRUE,TRUE,FALSE)&c(TRUE,FALSE,FALSE)
c(TRUE,TRUE,FALSE)|c(TRUE,FALSE,FALSE)
!TRUE
c(TRUE,TRUE,FALSE)&&c(TRUE,FALSE,FALSE)
c(TRUE,TRUE,FALSE)||c(TRUE,FALSE,FALSE)
```
Conditional Statements    
這裡我們要認識if,else if,else這三個語法   
請看以下程式碼，他綜合了if,else if,else的要素   
```{r}
a=66
if(a<10){
  if(a<5){
    result<-"extra small"
  }else{
    result<-"small"
  }
}else if (a<100){
  result<-"medium"
}else{
  result<-"large"
}
print(result)
```
請注意以下幾點    
1. 一定要對齊(就是照著換行後他給的位置寫)   
2. 前面的過關了(TRUE時)，後面的不管多精細多正確都不會被跑到(因為她只要有第一個TRUE時，就會跳出這個if式子)    

<h3 id = '2.2'></h3>
##Loops   
while loop    
以下程式碼將會有while用法和break使用時機
```{r}
i<-1
while(i<=10){
  print(3*i)
  if(3*i%%8==0){
    break
  }
  i<-i+1
}
```
如果沒有這個if和break，這個while迴圈會一直跑，跑到i變11   
因為當i==11的時候while(i<=10)會不成立(FALSE)，於是跳出這個迴圈    
但加了這個if和break，只要3*i能被8整除，break就會強制帶離這個while迴圈   
所以我們可以看到她到24(3*8)就不繼續到i<-11了  

for loop    
先以一個向量來介紹兩種for迴圈的寫法   
```{r}
linkedin<-c(16,9,13,5,2,17,14)
for(link in linkedin){
  print(link)
}#typeA
for(i in 1:length(linkedin)){
  print(linkedin[i])
}#typeB
```
兩種顯示結果都一樣，但是A比較值觀，B比較多功能和發展性    
for迴圈當然不只可以用在向量，也可以用在清單和矩陣...    
接下來要介紹break和next的差別   
break用法跟while迴圈一樣，會使迴圈強制跳出    
next很特別，他會跳過此項，然後繼續跑下面的項目
```{r}
for(li in linkedin){
  if(li>10){
    print("你好紅")
  }else{
    print("多爭取點關注度")
  }
  if(li>16){
    print("紅翻天了你")
    break
  }
  if(li<5){
    print("有點邊緣喔")
    next
  }
  print(li)
}
```
當數值是2(<5)時候，他只會說有點邊緣，不會print出他的數值(因為有next)，直接跳到下一個17，而17是紅翻天了你，接下來進行break，所以最後一個數值14不會跑   

<h3 id = '2.3'></h3>
## Functions
